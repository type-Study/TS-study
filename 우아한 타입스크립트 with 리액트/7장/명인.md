### Axios를 활용한 API요청

함수를 직접 사용하는 대신 Axios 라이브러리를 사용할 수 있다.

```ts
const apiRequester: AxiosInstance = axios.create({ baseURL: 'https://jsonplaceholder.typicode.com', timeout: 5000 })

const fetchUsers = (): AxiosPromise<FetchUsersResponse> => {
  return apiRequester.get<FetchUsersResponse>("users");
};
```

혹여나 API Entry가 2개 이상일 경우에는 2개 이상의 API 요청을 처리하는 인스턴스를 따로 구성해야 한다.  
이후 다른 URL로 서비스 코드를 호출할 떄는 각각의 apiRequester를 사용하면 된다.

```ts
const defaultConfig = {
  // ...
};

const apiRequester: AxiosInstance = axios.create(defaultConfig);

const orderApiRequester: AxiosInstance = axios.create({
  baseURL: "https://api.order",
  ...defaultConfig,
});

const orderCartApiRequester: AxiosInstance = axios.create({
  baseURL: "https://api.cart",
  ...defaultConfig,
});
```

### Axios 인터셉터 사용하기

request별로 다른 헤더를 설정해줘야 하는 경우가 존재할 수 있는데,  
이때  인터셉터 기능을 사용하여 요청에 따라 비동기 호출 내용을 추가해서 처리할 수 있다.

```ts
const apiRequester: AxiosInstance = axios.create({
  baseURL: '...',
  timeout: 5000
});

const setRequestDefaultHeader = (requestConfig: AxiosRequestConfig) => {
  const config = requestConfig;

  config.headers = {
    ...config.headers,
    'Content-Type': 'application/json:charset=utf-8',
    user : GetUserToken()
  }

  return config;
}

const setOrderRequestDefaultHeader = (requestConfig: AxiosRequestConfig) => {
  const config = requestConfig;

  config.headers = {
    ...config.headers,
    "Content-Type": "application/json:charset=utf-8",
    'order-client': getOrderClientToken();
  };

  return config;
};
```

위에서 만들어진 코드는 아래와 같이 사용된다.

```ts
// 기본 요청에 기능을 넣거나 에러를 처리할 수 있다.

const apiRequester: AxiosInstance = axios.create({
  baseURL: '...',
  timeout: 5000
});

apiRequester.interceptors.request.use(setRequestDefaultHeader)

// 기본 apiRequester과는 다른 header를 설정할 수 있다. 

const orderApiRequester: AxiosInstance = axios.create({
  baseURL: '...',
  timeout: 5000
});

orderApiRequester.interceptors.request.use(setOrderRequestDefaultHeader)
```